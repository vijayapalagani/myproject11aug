new code from marc1
